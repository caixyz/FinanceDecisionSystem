# 金融决策系统 - 登录功能使用说明

## 🎉 功能概述

您的金融决策系统现在已经成功添加了完整的用户登录和身份认证功能！

## 🔐 登录系统特性

### ✨ 主要功能
- **用户注册与管理** - 支持多用户系统
- **安全登录认证** - 基于Session的用户认证
- **权限控制** - 保护所有API接口，需要登录后才能访问
- **会话管理** - 7天自动过期，支持退出登录
- **响应式界面** - 现代化的登录和主页界面

### 🏠 页面导航
- **登录页面** - `/login` 
- **用户主页** - `/dashboard` (登录后)
- **原分析界面** - `/` (登录后可访问)

## 👤 默认用户账号

系统已自动创建以下测试账号：

### 管理员账户
- **用户名**: `admin`
- **密码**: `admin123`
- **权限**: 管理员权限

### 演示账户  
- **用户名**: `demo`
- **密码**: `demo123`
- **权限**: 普通用户权限

## 🚀 如何使用

### 1. 启动系统
```bash
python app.py
```

### 2. 访问登录页面
打开浏览器访问: [http://localhost:5000/login](http://localhost:5000/login)

### 3. 登录系统
- 在登录页面输入用户名和密码
- 或者点击演示账户信息自动填充
- 点击"登录"按钮

### 4. 使用主页功能
登录成功后会自动跳转到主页 (`/dashboard`)，您可以：
- 查看用户统计信息
- 进行股票分析
- 运行策略回测  
- 生成分析报告
- 访问完整分析界面

## 🛡️ 安全特性

### 密码安全
- 使用Salt+Hash加密存储密码
- 支持安全的密码验证

### 会话管理
- Session令牌自动过期（7天）
- 支持主动退出登录
- 防止未授权访问

### API保护
- 所有股票数据API都需要登录
- 自动重定向未登录用户到登录页面
- 支持JSON格式的错误响应

## 📊 数据库结构

### 用户表 (users)
- `id` - 用户ID (主键)
- `username` - 用户名 (唯一)
- `password_hash` - 加密密码
- `email` - 邮箱 (可选)
- `real_name` - 真实姓名 (可选)
- `role` - 用户角色 (user/admin)
- `created_at` - 创建时间
- `last_login` - 最后登录时间
- `is_active` - 是否激活

### 会话表 (user_sessions)
- `id` - 会话ID (主键)
- `user_id` - 用户ID (外键)
- `session_token` - 会话令牌 (唯一)
- `created_at` - 创建时间
- `expires_at` - 过期时间
- `is_active` - 是否活跃

## 🔧 API接口

### 认证相关
- `POST /api/auth/login` - 用户登录
- `POST /api/auth/logout` - 退出登录
- `GET /api/auth/check` - 检查登录状态
- `GET /api/auth/user` - 获取当前用户信息

### 用户信息
- `GET /api/user/statistics` - 获取用户统计信息
- `GET /api/user/activities` - 获取用户活动记录

### 股票数据 (需要登录)
- `GET /api/stocks/list` - 获取股票列表
- `GET /api/stocks/{symbol}/data` - 获取股票数据
- `GET /api/stocks/{symbol}/analysis` - 股票分析
- `GET /api/stocks/{symbol}/chart` - 生成图表
- `POST /api/backtest/run` - 运行回测
- `POST /api/reports/generate` - 生成报告

## 🎨 界面特色

### 登录页面
- 现代化渐变背景设计
- 响应式布局适配移动端
- 功能特性展示
- 演示账户一键填充

### 用户主页
- 个性化欢迎信息
- 实时时间显示
- 功能模块卡片式展示
- 用户统计数据面板
- 最近活动记录
- 快捷操作模态框

## 🔄 工作流程

1. **未登录用户** → 自动重定向到登录页面
2. **登录成功** → 跳转到用户主页
3. **会话有效期内** → 可以正常访问所有功能
4. **会话过期** → 自动重定向到登录页面
5. **主动退出** → 清除会话，返回登录页面

## 📱 移动端支持

系统完全支持移动端访问：
- 响应式设计自动适配屏幕尺寸
- 触摸友好的交互界面
- 优化的移动端导航体验

## ⚡ 性能优化

- Session令牌缓存
- 数据库连接池
- 静态资源优化
- 前端资源压缩

## 🐛 故障排除

### 登录失败
1. 检查用户名和密码是否正确
2. 确认用户账户是否激活
3. 查看服务器日志获取详细错误信息

### 会话过期
1. 重新登录即可
2. 检查系统时间是否正确
3. 确认会话配置是否正常

### 权限错误
1. 确认用户角色和权限设置
2. 重新登录刷新权限
3. 联系管理员检查用户状态

## 🎊 恭喜！

您的金融决策系统现在拥有了完整的用户认证功能！

**预览浏览器已准备就绪** - 请点击工具面板中的按钮开始体验新的登录功能。

建议您首先尝试：
1. 访问登录页面
2. 使用演示账户登录 (`demo` / `demo123`)
3. 体验用户主页的各项功能
4. 测试退出登录功能

系统完全向后兼容，原有的股票分析功能都得到了保留和增强！